# Rudis 2026 发展路线图

## 概述

2026 年，Rudis 将继续专注于提升性能、扩展功能和增强兼容性，目标是打造一个功能完善、性能卓越、高度兼容 Redis 的 Rust 实现。本路线图规划了四个主要开发阶段，涵盖地理信息处理、JSON 数据结构完善、流数据处理、集群架构等核心功能。

---

## 第一阶段：地理信息支持与核心优化

**版本：v0.5.0**

### 核心特性

#### 1. 地理信息（GEO）数据结构

**GEOADD 命令**
- [ ] 实现基于 Sorted Set 的 GEO 存储结构
- [ ] 集成 Geohash 编码算法（评估 geo-rust 库或自实现）
- [ ] 支持批量添加经纬度坐标
- [ ] 验证经度范围 -180 到 180 度，纬度范围 -85.05112878 到 85.05112878 度
- [ ] 实现参数解析和错误处理
- [ ] 编写单元测试（正常情况、边界值、非法输入）
- [ ] 添加命令文档

**GEOPOS 命令**
- [ ] 实现从 Geohash 解码回经纬度坐标
- [ ] 支持批量查询多个成员
- [ ] 处理不存在成员返回 nil
- [ ] 编写单元测试
- [ ] 添加命令文档

**GEODIST 命令**
- [ ] 实现 Haversine 公式计算球面距离
- [ ] 支持 m（米）、km（千米）、mi（英里）、ft（英尺）单位转换
- [ ] 处理单位参数解析和默认值（米）
- [ ] 高精度浮点数计算
- [ ] 编写单元测试（包含不同单位测试）
- [ ] 添加命令文档

**GEORADIUS 命令**
- [ ] 实现以给定经纬度为中心的半径查询算法
- [ ] 支持 WITHDIST 选项（返回距离）
- [ ] 支持 WITHCOORD 选项（返回坐标）
- [ ] 支持 WITHHASH 选项（返回 Geohash）
- [ ] 支持 COUNT 参数限制返回数量
- [ ] 支持 ASC/DESC 排序
- [ ] 优化查询性能（使用 Geohash 范围缩小搜索空间）
- [ ] 编写单元测试
- [ ] 添加命令文档

**GEORADIUSBYMEMBER 命令**
- [ ] 实现以已存在成员为中心的半径查询
- [ ] 复用 GEORADIUS 的核心逻辑
- [ ] 支持所有 GEORADIUS 的选项参数
- [ ] 处理成员不存在的情况
- [ ] 编写单元测试
- [ ] 添加命令文档

**GEOHASH 命令**
- [ ] 实现返回位置的 Geohash 字符串
- [ ] 支持批量查询
- [ ] 编写单元测试
- [ ] 添加命令文档

#### 2. 底层技术实现
- [ ] 研究并选择 Geohash 算法库（geo-rust vs 自实现）
- [ ] 设计 GEO 数据在 Sorted Set 中的存储格式
- [ ] 实现 Geohash 编码/解码工具函数
- [ ] 实现 Haversine 距离计算函数
- [ ] 支持 GEO 数据的 RDB 序列化/反序列化
- [ ] 支持 GEO 命令的 AOF 记录
- [ ] 性能测试和优化

#### 3. 性能优化
- [ ] 优化 SCAN 系列命令的内存占用
- [ ] 改进 AOF 重写机制，减少磁盘 I/O
- [ ] 优化 Sorted Set 范围查询性能
- [ ] 进行性能基准测试并记录报告

#### 4. 功能增强
- [ ] 实现 GETEX 命令（获取键值并设置过期时间）
- [ ] 实现 GETDEL 命令（获取并删除键）
- [ ] 实现 COPY 命令（复制键到新位置）
- [ ] 改进 TTL 精度和过期键清理策略
- [ ] 为新命令编写测试用例
- [ ] 为新命令添加文档

### 交付物
- [ ] 发布 v0.5.0 稳定版本
- [ ] 编写 GEO 命令完整文档
- [ ] 编写地理信息使用示例和最佳实践
- [ ] 输出性能测试报告

---

## 第二阶段：JSON 数据结构完善

**版本：v0.6.0**

### 核心特性

#### 1. 完整 JSON 支持

**JSON.SET 完善**
- [ ] 实现完整的 JSONPath 路径操作（$.path.to.field）
- [ ] 支持数组索引和切片（$[0], $[1:3]）
- [ ] 支持递归下降操作符（$..name）
- [ ] 支持过滤表达式（$[?(@.price < 10)]）
- [ ] 支持 NX/XX 条件设置
- [ ] 编写单元测试（包含复杂路径测试）
- [ ] 添加命令文档

**JSON.GET 增强**
- [ ] 实现多路径查询功能
- [ ] 支持 INDENT、NEWLINE、SPACE 格式化选项
- [ ] 支持 NOESCAPE 选项
- [ ] 优化大 JSON 对象的读取性能
- [ ] 编写单元测试
- [ ] 添加命令文档

**JSON.MGET 命令**
- [ ] 实现批量获取多个键的 JSON 值
- [ ] 支持相同路径查询
- [ ] 优化批量读取性能
- [ ] 编写单元测试
- [ ] 添加命令文档

**JSON.TYPE 命令**
- [ ] 实现获取 JSON 值类型功能
- [ ] 返回类型：string、number、boolean、null、object、array
- [ ] 支持路径参数
- [ ] 编写单元测试
- [ ] 添加命令文档

**JSON 字符串和数组长度命令**
- [ ] 实现 JSON.STRLEN（获取 JSON 字符串长度）
- [ ] 实现 JSON.ARRLEN（获取 JSON 数组长度）
- [ ] 实现 JSON.OBJLEN（获取 JSON 对象键数量）
- [ ] 支持路径参数
- [ ] 编写单元测试
- [ ] 添加命令文档

**JSON 数组操作命令**
- [ ] 实现 JSON.ARRAPPEND（向 JSON 数组追加元素）
- [ ] 实现 JSON.ARRINSERT（向 JSON 数组指定位置插入元素）
- [ ] 实现 JSON.ARRPOP（从 JSON 数组弹出元素）
- [ ] 实现 JSON.ARRTRIM（修剪 JSON 数组）
- [ ] 支持批量操作
- [ ] 编写单元测试
- [ ] 添加命令文档

**JSON 数值操作命令**
- [ ] 实现 JSON.NUMINCRBY（增加 JSON 数字值）
- [ ] 实现 JSON.NUMMULTBY（乘以 JSON 数字值）
- [ ] 支持浮点数和整数
- [ ] 处理溢出和精度问题
- [ ] 编写单元测试
- [ ] 添加命令文档

**JSON 其他操作命令**
- [ ] 实现 JSON.TOGGLE（切换 JSON 布尔值）
- [ ] 实现 JSON.CLEAR（清空 JSON 容器）
- [ ] 编写单元测试
- [ ] 添加命令文档

#### 2. 底层技术实现
- [ ] 评估并优化 serde_json 的使用
- [ ] 实现或集成 JSONPath 引擎（评估 jsonpath_lib）
- [ ] 设计 JSON 数据的索引结构
- [ ] 实现 JSON 增量更新机制
- [ ] 优化 JSON 解析和序列化性能
- [ ] 支持 JSON 数据的 RDB 持久化
- [ ] 支持 JSON 命令的 AOF 记录

#### 3. 高级特性
- [ ] 研究并实现 JSON Schema 验证（可选功能）
- [ ] 实现 JSON 数据压缩存储
- [ ] 优化 JSON 搜索和过滤性能
- [ ] 进行性能基准测试

### 交付物
- [ ] 发布 v0.6.0 稳定版本
- [ ] 编写 JSON 命令完整文档
- [ ] 编写 JSONPath 使用指南和示例
- [ ] 输出 JSON 性能基准测试报告

---

## 第三阶段：Stream 流数据处理

**版本：v0.7.0**

### 核心特性

#### 1. Stream 数据结构

**XADD 命令**
- [ ] 实现基于 Radix Tree 的 Stream 存储结构
- [ ] 实现自动生成唯一消息 ID（时间戳-序列号格式）
- [ ] 支持 MAXLEN 参数限制流长度
- [ ] 支持 MINID 参数设置最小消息 ID
- [ ] 支持 NOMKSTREAM 选项
- [ ] 实现消息 ID 生成算法
- [ ] 编写单元测试
- [ ] 添加命令文档

**XREAD 命令**
- [ ] 实现阻塞模式读取
- [ ] 实现非阻塞模式读取
- [ ] 支持多流同时读取
- [ ] 支持 BLOCK 超时参数
- [ ] 支持 COUNT 参数限制读取数量
- [ ] 实现流监听和通知机制
- [ ] 编写单元测试
- [ ] 添加命令文档

**XRANGE/XREVRANGE 命令**
- [ ] 实现按 ID 范围查询消息
- [ ] 实现正向遍历（XRANGE）
- [ ] 实现反向遍历（XREVRANGE）
- [ ] 支持 COUNT 参数
- [ ] 支持特殊 ID（-、+）
- [ ] 优化范围查询性能
- [ ] 编写单元测试
- [ ] 添加命令文档

**基础 Stream 管理命令**
- [ ] 实现 XLEN（获取流长度）
- [ ] 实现 XDEL（删除流消息）
- [ ] 实现 XTRIM（修剪流）
- [ ] 编写单元测试
- [ ] 添加命令文档

#### 2. 消费者组（Consumer Group）

**消费者组管理命令**
- [ ] 实现 XGROUP CREATE（创建消费者组）
- [ ] 实现 XGROUP DESTROY（删除消费者组）
- [ ] 实现 XGROUP SETID（设置消费者组 ID）
- [ ] 设计消费者组状态存储结构
- [ ] 编写单元测试
- [ ] 添加命令文档

**XREADGROUP 命令**
- [ ] 实现消费者组读取功能
- [ ] 支持消息确认机制
- [ ] 实现待处理消息列表（Pending List）
- [ ] 支持 NOACK 选项
- [ ] 支持 BLOCK 和 COUNT 参数
- [ ] 编写单元测试
- [ ] 添加命令文档

**消息确认和转移命令**
- [ ] 实现 XACK（确认消息）
- [ ] 实现 XPENDING（查看待处理消息）
- [ ] 实现 XCLAIM（转移消息所有权）
- [ ] 处理消息超时和重试逻辑
- [ ] 编写单元测试
- [ ] 添加命令文档

#### 3. 底层技术实现
- [ ] 研究并实现 Radix Tree 数据结构
- [ ] 设计 Stream 消息存储格式
- [ ] 实现高效的消息 ID 比较和排序
- [ ] 实现消费者组状态管理
- [ ] 支持 Stream 数据的 RDB 持久化
- [ ] 支持 Stream 命令的 AOF 记录
- [ ] 优化内存占用和性能

#### 4. 监控和管理
- [ ] 实现 XINFO STREAM（查看流信息）
- [ ] 实现 XINFO GROUPS（查看消费者组信息）
- [ ] 实现 XINFO CONSUMERS（查看消费者信息）
- [ ] 编写单元测试
- [ ] 添加命令文档

### 交付物
- [ ] 发布 v0.7.0 稳定版本
- [ ] 编写 Stream 命令完整文档
- [ ] 编写消息队列使用案例和最佳实践
- [ ] 输出流处理性能报告

---

## 第四阶段：集群与高级特性

**版本：v0.8.0 - v1.0.0**

### v0.8.0：集群架构基础

#### 1. Cluster 基础

**节点管理**
- [ ] 实现节点发现和握手协议
- [ ] 实现哈希槽分配机制（16384 个槽）
- [ ] 实现数据分片和路由逻辑
- [ ] 实现 MOVED 重定向
- [ ] 实现 ASK 重定向
- [ ] 设计集群拓扑存储结构
- [ ] 编写单元测试
- [ ] 添加文档

**集群命令**
- [ ] 实现 CLUSTER NODES（查看集群节点）
- [ ] 实现 CLUSTER SLOTS（查看槽分配）
- [ ] 实现 CLUSTER ADDSLOTS（分配槽）
- [ ] 实现 CLUSTER DELSLOTS（删除槽）
- [ ] 实现 CLUSTER SETSLOT（设置槽状态）
- [ ] 实现 CLUSTER INFO（集群信息）
- [ ] 编写单元测试
- [ ] 添加文档

**故障转移**
- [ ] 实现节点健康检测（心跳机制）
- [ ] 实现自动故障转移逻辑
- [ ] 实现手动故障转移命令
- [ ] 实现主从切换通知机制
- [ ] 编写单元测试
- [ ] 添加文档

#### 2. Pub/Sub 增强

**模式订阅**
- [ ] 实现 PSUBSCRIBE（模式订阅）
- [ ] 实现 PUNSUBSCRIBE（取消模式订阅）
- [ ] 实现 PUBSUB NUMPAT（查看模式订阅数）
- [ ] 优化模式匹配性能
- [ ] 编写单元测试
- [ ] 添加文档

**分片 Pub/Sub**
- [ ] 实现 SSUBSCRIBE（分片频道订阅）
- [ ] 实现 SUNSUBSCRIBE（取消分片订阅）
- [ ] 实现 SPUBLISH（发布到分片频道）
- [ ] 实现分片频道路由逻辑
- [ ] 编写单元测试
- [ ] 添加文档

#### 交付物
- [ ] 发布 v0.8.0 稳定版本
- [ ] 编写集群部署指南
- [ ] 编写故障转移文档
- [ ] 输出集群性能测试报告

---

### v0.9.0：安全性与监控增强

#### 1. ACL 访问控制列表

**ACL 用户管理**
- [ ] 实现 ACL SETUSER（创建/修改用户）
- [ ] 实现 ACL GETUSER（获取用户信息）
- [ ] 实现 ACL DELUSER（删除用户）
- [ ] 实现 ACL LIST（列出所有用户）
- [ ] 实现 ACL WHOAMI（查看当前用户）
- [ ] 设计 ACL 权限存储结构
- [ ] 编写单元测试
- [ ] 添加文档

**ACL 权限控制**
- [ ] 实现命令级别权限控制
- [ ] 实现键模式权限控制
- [ ] 实现频道权限控制
- [ ] 实现 ACL 规则解析引擎
- [ ] 编写单元测试
- [ ] 添加文档

#### 2. TLS/SSL 支持

**加密传输**
- [ ] 集成 rustls 或 ring 库
- [ ] 实现 TLS 握手逻辑
- [ ] 支持证书认证
- [ ] 支持双向认证（可选）
- [ ] 实现配置化管理
- [ ] 编写单元测试
- [ ] 添加文档

#### 3. 慢查询日志

**慢查询管理**
- [ ] 实现慢查询检测逻辑
- [ ] 实现 SLOWLOG GET（获取慢查询）
- [ ] 实现 SLOWLOG LEN（慢查询数量）
- [ ] 实现 SLOWLOG RESET（清空慢查询）
- [ ] 支持慢查询阈值配置
- [ ] 编写单元测试
- [ ] 添加文档

#### 4. 内存分析

**内存诊断命令**
- [ ] 实现 MEMORY USAGE（查看键内存占用）
- [ ] 实现 MEMORY STATS（内存统计信息）
- [ ] 实现 MEMORY DOCTOR（内存诊断建议）
- [ ] 实现内存采样和分析逻辑
- [ ] 编写单元测试
- [ ] 添加文档

#### 5. 性能指标

**监控增强**
- [ ] 增强 INFO 命令（添加更多统计项）
- [ ] 实现实时性能监控接口
- [ ] 实现 Prometheus metrics 导出
- [ ] 实现性能指标采集机制
- [ ] 编写监控文档
- [ ] 提供 Grafana 仪表板模板

#### 交付物
- [ ] 发布 v0.9.0 稳定版本
- [ ] 编写 ACL 使用指南
- [ ] 编写 TLS 配置文档
- [ ] 编写监控和诊断文档

---

### v1.0.0：生产就绪版本

#### 1. 高级数据结构

**Bitmap 完善**
- [ ] 实现 BITPOS（查找位位置）
- [ ] 实现 BITFIELD（位域操作）
- [ ] 支持多种位域类型
- [ ] 编写单元测试
- [ ] 添加文档

**Bloom Filter**
- [ ] 实现 BF.ADD（添加元素）
- [ ] 实现 BF.EXISTS（检查元素存在）
- [ ] 实现 BF.MADD（批量添加）
- [ ] 实现 BF.MEXISTS（批量检查）
- [ ] 实现 BF.RESERVE（创建过滤器）
- [ ] 集成或实现 Bloom Filter 算法
- [ ] 编写单元测试
- [ ] 添加文档

**Top-K**
- [ ] 实现 TOPK.ADD（添加元素）
- [ ] 实现 TOPK.QUERY（查询 Top-K）
- [ ] 实现 TOPK.LIST（列出 Top-K 元素）
- [ ] 实现 TOPK.RESERVE（创建 Top-K）
- [ ] 实现 Top-K 算法（Count-Min Sketch + Heap）
- [ ] 编写单元测试
- [ ] 添加文档

#### 2. 生态集成

**工具兼容性**
- [ ] 完整兼容 Redis Desktop Manager
- [ ] 完整兼容 Redis CLI 工具
- [ ] 测试主流编程语言客户端（Python、Java、Node.js、Go、Rust）
- [ ] 编写客户端兼容性文档

**容器化部署**
- [ ] 提供 Docker Compose 编排模板
- [ ] 实现 Kubernetes Operator（可选）
- [ ] 提供 Helm Chart（可选）
- [ ] 编写容器化部署文档

**迁移工具**
- [ ] 开发 Redis 到 Rudis 迁移工具
- [ ] 支持 RDB 文件导入
- [ ] 支持 AOF 文件导入
- [ ] 编写迁移指南

#### 3. 文档完善

**用户文档**
- [ ] 完善中英文用户手册
- [ ] 编写在线交互式教程
- [ ] 整理使用案例和最佳实践
- [ ] 编写性能调优手册
- [ ] 编写故障排查指南

**开发者文档**
- [ ] 编写架构设计文档
- [ ] 编写贡献者指南
- [ ] 编写代码规范文档
- [ ] 编写测试指南

#### 交付物
- [ ] 发布 v1.0.0 生产就绪版本
- [ ] 发布完整用户手册
- [ ] 发布运维和调优指南
- [ ] 发布迁移工具和文档
- [ ] 举办线上发布会

---

## 持续改进

### 性能优化
- [ ] 优化内存使用，降低内存占用
- [ ] 提升并发处理能力，支持更高 QPS
- [ ] 优化网络协议，减少延迟
- [ ] 加速 RDB 持久化性能
- [ ] 加速 AOF 持久化性能
- [ ] 进行持续的性能基准测试

### 稳定性提升
- [ ] 完善单元测试覆盖率（目标 80%+）
- [ ] 增加集成测试用例
- [ ] 进行压力测试和稳定性测试
- [ ] 实施内存泄漏检测和修复
- [ ] 加强边界条件处理
- [ ] 建立 CI/CD 流水线

### 兼容性保障
- [ ] 确保 Redis 协议完全兼容
- [ ] 测试主流 Redis 客户端
- [ ] 提高常用 Redis 命令覆盖率至 95%+
- [ ] 进行行为一致性验证
- [ ] 建立兼容性测试套件

### 文档和社区
- [ ] 完善中英文文档
- [ ] 开发在线交互式教程
- [ ] 整理使用案例和最佳实践
- [ ] 建立活跃的社区支持渠道
- [ ] 定期发布技术博客和更新日志

---

## 技术栈

### 核心依赖
- **Rust**：1.75+ 稳定版
- **Tokio**：异步运行时
- **DashMap**：并发哈希表
- **SkipList**：跳表实现
- **Bincode**：二进制序列化
- **Serde**：数据序列化框架

### 新增依赖
- **geo**：地理信息处理
- **geohash**：Geohash 编码
- **jsonpath_lib**：JSONPath 解析
- **radix_trie**：Stream 存储
- **bloom**：布朗过滤器
- **ring/rustls**：TLS 支持

---

## 里程碑

| 阶段 | 版本 | 目标完成时间 | 核心特性 |
|------|------|-------------|---------|
| 第一阶段 | v0.5.0 | Q1 | 地理信息支持 |
| 第二阶段 | v0.6.0 | Q2 | JSON 数据结构完善 |
| 第三阶段 | v0.7.0 | Q3 | Stream 流数据处理 |
| 第四阶段 | v0.8.0 | Q4 | 集群架构 |
| 第四阶段 | v0.9.0 | Q4 | 安全与监控 |
| 第四阶段 | v1.0.0 | Q4 | 生产就绪版本 |

---

## 贡献指南

我们欢迎社区贡献者参与 Rudis 的开发！你可以通过以下方式参与：

- [ ] **功能开发**：选择感兴趣的功能进行实现
- [ ] **Bug 修复**：帮助发现和修复问题
- [ ] **文档改进**：完善文档和示例
- [ ] **测试用例**：编写更多测试用例
- [ ] **性能优化**：提供性能改进建议和实现

详细的贡献流程请参考 [CONTRIBUTING.md](./CONTRIBUTING.md)

---

## 联系方式

- **GitHub**：https://github.com/sleeprite/rudis
- **Gitee**：https://gitee.com/Jmysy/rudis
- **文档站**：https://sleeprite.github.io/rudis
- **问题反馈**：https://github.com/sleeprite/rudis/issues

---

## 许可证

Rudis 遵循 [GNU GENERAL PUBLIC LICENSE v3.0](./LICENSE) 开源协议。

---

**让我们一起打造更强大的 Rudis！** 🚀
